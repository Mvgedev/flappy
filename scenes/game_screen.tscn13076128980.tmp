[gd_scene load_steps=19 format=3 uid="uid://c5gydx4og72e"]

[ext_resource type="PackedScene" uid="uid://bqt183ikvb1ni" path="res://scenes/player.tscn" id="1_8mhku"]
[ext_resource type="Script" uid="uid://d1g147ojau25o" path="res://scripts/game_manager.gd" id="1_85ytm"]
[ext_resource type="Texture2D" uid="uid://cjcgxip2mdvsa" path="res://assets/sprites/background.png" id="1_vnpv3"]
[ext_resource type="Texture2D" uid="uid://5veg4qanxl7n" path="res://assets/sprites/mid_bg2.png" id="2_2yu03"]
[ext_resource type="Texture2D" uid="uid://bj3eignyh0rxf" path="res://assets/sprites/foreground.png" id="2_4m8lb"]
[ext_resource type="PackedScene" uid="uid://cyo4n6qvd65tp" path="res://scenes/killzone.tscn" id="3_3uriw"]
[ext_resource type="Texture2D" uid="uid://dag12bwiwf4qf" path="res://assets/sprites/mid_background.png" id="3_5vo8s"]
[ext_resource type="Texture2D" uid="uid://d0i20lu022q7k" path="res://assets/sprites/UI Box.png" id="3_rxmqw"]
[ext_resource type="FontFile" uid="uid://yxv4f1wj3ql8" path="res://assets/fonts/GothicPixels.ttf" id="4_dv2sx"]
[ext_resource type="Texture2D" uid="uid://c5pk38y6wc0pu" path="res://assets/sprites/Button_Normal.png" id="5_dthvl"]
[ext_resource type="Texture2D" uid="uid://clvbuuw6v5juw" path="res://assets/sprites/Button_Pressed.png" id="6_r01d7"]
[ext_resource type="Script" uid="uid://cpb0bt4ff01hd" path="res://scripts/retry_button.gd" id="7_r01d7"]
[ext_resource type="AudioStream" uid="uid://twk6gjl0addo" path="res://assets/sounds/sfx/explosion.wav" id="13_vqtp5"]
[ext_resource type="AudioStream" uid="uid://dcbcm48f8s5tw" path="res://assets/sounds/sfx/loose.wav" id="14_8tvxp"]
[ext_resource type="AudioStream" uid="uid://wdotv8rdg4l6" path="res://assets/sounds/sfx/score.wav" id="15_8tvxp"]

[sub_resource type="SegmentShape2D" id="SegmentShape2D_3uriw"]
a = Vector2(-292, 0)
b = Vector2(302, 0)

[sub_resource type="SegmentShape2D" id="SegmentShape2D_dv2sx"]
a = Vector2(-291, 0)
b = Vector2(289, 0)

[sub_resource type="SegmentShape2D" id="SegmentShape2D_rxmqw"]
a = Vector2(0, 162)
b = Vector2(0, -160)

[node name="GameScreen" type="Node2D"]

[node name="Landscape" type="Node" parent="."]

[node name="Background" type="Sprite2D" parent="Landscape"]
texture = ExtResource("1_vnpv3")

[node name="ParallaxTentacles" type="Parallax2D" parent="Landscape"]
scroll_scale = Vector2(-1, 0)
repeat_size = Vector2(576, 0)
autoscroll = Vector2(-30, 0)
follow_viewport = false
ignore_camera_scroll = true

[node name="Sprite2D" type="Sprite2D" parent="Landscape/ParallaxTentacles"]
texture = ExtResource("2_2yu03")

[node name="ParallaxRocks" type="Parallax2D" parent="Landscape"]
scroll_scale = Vector2(-1, 0)
repeat_size = Vector2(576, 0)
autoscroll = Vector2(-50, 0)
follow_viewport = false
ignore_camera_scroll = true

[node name="RocksMidground" type="Sprite2D" parent="Landscape/ParallaxRocks"]
texture = ExtResource("3_5vo8s")

[node name="ParallaxForeground" type="Parallax2D" parent="Landscape"]
scroll_scale = Vector2(-1, 0)
repeat_size = Vector2(576, 0)
autoscroll = Vector2(-70, 0)
follow_viewport = false
ignore_camera_scroll = true

[node name="Cave Foreground" type="Sprite2D" parent="Landscape/ParallaxForeground"]
z_index = 5
texture = ExtResource("2_4m8lb")

[node name="GameManager" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("1_85ytm")

[node name="Player" parent="." instance=ExtResource("1_8mhku")]
unique_name_in_owner = true
position = Vector2(-200, -13)

[node name="Camera2D" type="Camera2D" parent="."]
zoom = Vector2(2, 2)

[node name="CanvasLayer" type="CanvasLayer" parent="."]
follow_viewport_enabled = true

[node name="UIPanel" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchor_left = -0.25
anchor_top = -0.25
anchor_right = 0.25
anchor_bottom = 0.25
grow_horizontal = 2
grow_vertical = 2
metadata/_edit_use_anchors_ = true

[node name="TextureRect" type="TextureRect" parent="CanvasLayer/UIPanel"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -128.0
offset_top = -64.0
offset_right = 128.0
offset_bottom = 64.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("3_rxmqw")
stretch_mode = 3

[node name="GameOver" type="Label" parent="CanvasLayer/UIPanel/TextureRect"]
layout_mode = 0
offset_left = -6.0
offset_top = 10.0
offset_right = 262.0
offset_bottom = 42.0
theme_override_colors/font_color = Color(0.11372549, 0.11372549, 0.2901961, 1)
theme_override_fonts/font = ExtResource("4_dv2sx")
theme_override_font_sizes/font_size = 32
text = "Game Over!"
horizontal_alignment = 1

[node name="Recap score" type="Label" parent="CanvasLayer/UIPanel/TextureRect"]
layout_mode = 0
offset_left = -2.0
offset_top = 47.0
offset_right = 258.0
offset_bottom = 82.0
theme_override_colors/font_color = Color(0.11372549, 0.11372549, 0.2901961, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_fonts/font = ExtResource("4_dv2sx")
text = "Your score is: X
Your best score is: X"
horizontal_alignment = 1

[node name="RetryButton" type="TextureButton" parent="CanvasLayer/UIPanel/TextureRect"]
layout_mode = 0
offset_left = 104.0
offset_top = 90.0
offset_right = 152.0
offset_bottom = 114.0
texture_normal = ExtResource("5_dthvl")
texture_pressed = ExtResource("6_r01d7")
script = ExtResource("7_r01d7")

[node name="Label" type="Label" parent="CanvasLayer/UIPanel/TextureRect/RetryButton"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/font = ExtResource("4_dv2sx")
theme_override_font_sizes/font_size = 16
text = "Play"
horizontal_alignment = 1
vertical_alignment = 1

[node name="Labels" type="Node" parent="CanvasLayer"]

[node name="Score" type="Label" parent="CanvasLayer/Labels"]
offset_left = -279.0
offset_top = -155.0
offset_right = -208.0
offset_bottom = -132.0
theme_override_fonts/font = ExtResource("4_dv2sx")
theme_override_font_sizes/font_size = 16
text = "Score: X"

[node name="Best Score" type="Label" parent="CanvasLayer/Labels"]
offset_left = -279.0
offset_top = -134.0
offset_right = -115.0
offset_bottom = -111.0
theme_override_fonts/font = ExtResource("4_dv2sx")
theme_override_font_sizes/font_size = 16
text = "Best score: X"

[node name="Instruction" type="Label" parent="CanvasLayer/Labels"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -781.0
offset_top = -341.5
offset_right = -371.0
offset_bottom = -306.5
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/font = ExtResource("4_dv2sx")
theme_override_font_sizes/font_size = 16
text = "Press space or left mouse button
to start the game"
horizontal_alignment = 1

[node name="Borders" type="Node" parent="."]

[node name="KillzoneBottom" parent="Borders" instance=ExtResource("3_3uriw")]
position = Vector2(0, 168)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Borders/KillzoneBottom"]
shape = SubResource("SegmentShape2D_3uriw")

[node name="KillzoneTop" parent="Borders" instance=ExtResource("3_3uriw")]
position = Vector2(0, -167)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Borders/KillzoneTop"]
shape = SubResource("SegmentShape2D_dv2sx")

[node name="BorderLeft" type="Area2D" parent="Borders"]
position = Vector2(-336, 1)
collision_mask = 4

[node name="CollisionShape2D" type="CollisionShape2D" parent="Borders/BorderLeft"]
shape = SubResource("SegmentShape2D_rxmqw")

[node name="BorderRight" type="Area2D" parent="Borders"]
position = Vector2(393, 1)
collision_layer = 3

[node name="CollisionShape2D" type="CollisionShape2D" parent="Borders/BorderRight"]
shape = SubResource("SegmentShape2D_rxmqw")

[node name="Obstacles" type="Node" parent="."]

[node name="SFX" type="Node" parent="."]

[node name="Explosion" type="AudioStreamPlayer2D" parent="SFX"]
stream = ExtResource("13_vqtp5")
bus = &"SFX"

[node name="Loose" type="AudioStreamPlayer2D" parent="SFX"]
stream = ExtResource("14_8tvxp")
bus = &"SFX"

[node name="ScoreSFX" type="AudioStreamPlayer2D" parent="SFX"]
stream = ExtResource("15_8tvxp")
bus = &"SFX"

[connection signal="button_down" from="CanvasLayer/UIPanel/TextureRect/RetryButton" to="CanvasLayer/UIPanel/TextureRect/RetryButton" method="_on_button_down"]
[connection signal="button_up" from="CanvasLayer/UIPanel/TextureRect/RetryButton" to="CanvasLayer/UIPanel/TextureRect/RetryButton" method="_on_button_up"]
[connection signal="pressed" from="CanvasLayer/UIPanel/TextureRect/RetryButton" to="GameManager" method="_on_retry_button_pressed"]
[connection signal="area_entered" from="Borders/BorderLeft" to="GameManager" method="_on_border_left_area_entered"]
